
export HISTFILE=~/.zsh_history

# --- Prompt & Zoxide ---
# Load Starship for all roles (or wrap in 'if ne .role "server"' if preferred)
if command -v starship >/dev/null 2>&1; then
    eval "$(starship init zsh)"
fi

if command -v zoxide >/dev/null 2>&1; then
    eval "$(zoxide init zsh --cmd cd)"
fi

# Claude Code / Node certs (PopOS/Debian paths vary, usually /etc/ssl/certs)
if [ -f /etc/ssl/cert.pem ]; then
    export NODE_EXTRA_CA_CERTS=/etc/ssl/cert.pem
fi
frank@pop-os:~/.local/share/chezmoi$ n dot_zshrc.tmpl
n: command not found
frank@pop-os:~/.local/share/chezmoi$ # GENERATED BY CHEZMOI - {{ .chezmoi.hostname }} ({{ .role }})

# --- macOS-specific initialization ---
{{- if eq .chezmoi.os "darwin" }}
export PYENV_ROOT="$HOME/.pyenv"
command -v pyenv >/dev/null || export PATH="$PYENV_ROOT/bin:$PATH"
eval "$(pyenv init -)"

# Homebrew paths
export PATH="/opt/homebrew/bin:/usr/local/bin:$PATH"

# zsh-autosuggestions (only if brew exists)
if command -v brew >/dev/null 2>&1; then
    # Cache the prefix to speed up shell startup
    BREW_PREFIX=$(brew --prefix)
    if [ -f "$BREW_PREFIX/share/zsh-autosuggestions/zsh-autosuggestions.zsh" ]; then
        source "$BREW_PREFIX/share/zsh-autosuggestions/zsh-autosuggestions.zsh"
    fi
fi
{{- end }}

# --- Universal PATH ---
# Prioritize local binaries (Starship, eza, yazi, etc.)
export PATH="$HOME/.local/bin:/usr/local/bin:$PATH"

# fzf key bindings and completion
[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

# --- Load Shared Aliases (The Master List) ---
# Sourced directly so updates to dot_aliases are immediate
[[ -f ~/.aliases ]] && source ~/.aliase
